<!-- templates/index.html -->
{% extends "base.html" %} {% block content %}
<div class="row">
  <div class="col-md-9">
    <div class="card card-lg p-3">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Danh sách sách</h4>
        <a
          href="{{ url_for('create_book') }}"
          class="btn btn-outline-primary btn-sm"
          >Thêm sách mới</a
        >
      </div>

      <table class="table table-hover">
        <thead>
          <tr>
            <th>Tiêu đề</th>
            <th>Tác giả</th>
            <th>Số lượng (còn)</th>
            <th>Hành động</th>
          </tr>
        </thead>
        <tbody>
          {% for book in books %}
          <tr>
            <td>{{ book.title }}</td>
            <td>{{ book.author or '-' }}</td>
            <td>{{ book.available_copies }} / {{ book.total_copies }}</td>
            <td style="min-width: 320px">
              <div class="d-flex gap-2">
                <a
                  href="{{ url_for('edit_book', book_id=book.id) }}"
                  class="btn btn-sm btn-outline-secondary"
                  >Sửa</a
                >

                <form
                  action="{{ url_for('delete_book', book_id=book.id) }}"
                  method="post"
                  onsubmit="return confirm('Bạn có chắc muốn xóa sách này?');"
                >
                  <button type="submit" class="btn btn-sm btn-outline-danger">
                    Xóa
                  </button>
                </form>

                <!-- borrow form -->
                <form
                  action="{{ url_for('borrow_book', book_id=book.id) }}"
                  method="post"
                  class="d-flex gap-1 align-items-center"
                >
                  <input
                    name="borrower_name"
                    type="text"
                    class="form-control form-control-sm"
                    placeholder="Tên người mượn"
                    style="width: 160px"
                    required
                  />
                  <button
                    type="submit"
                    class="btn btn-sm btn-primary"
                    {%
                    if
                    book.available_copies
                    <
                    1
                    %}disabled{%
                    endif
                    %}
                  >
                    Mượn
                  </button>
                </form>
              </div>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="4">Chưa có sách nào.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card card-lg p-3">
      <h6>Thông tin nhanh</h6>
      <p class="mb-1">Tổng sách: <strong>{{ books|length }}</strong></p>
      <p class="mb-1">
        <a href="{{ url_for('view_borrows') }}">Xem danh sách mượn/trả</a>
      </p>
    </div>
  </div>
</div>
{% endblock %}
